import React from 'react';
import PropTypes from 'prop-types';
import { createBrowserHistory } from 'history';
import { storiesOf } from '@storybook/react';
import { compose } from 'redux';
import { connect, Provider as StoreProvider } from 'react-redux';
import { routerMiddleware, connectRouter, ConnectedRouter, LOCATION_CHANGE } from 'connected-react-router';
import { configureStore } from '../../stories';
import routeDependencies from './routeDependencies';
export var history = createBrowserHistory();
var initialState = {
  users: {
    data: []
  }
};
var store = configureStore(initialState, {
  users: function users() {
    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
      data: []
    };
    var action = arguments.length > 1 ? arguments[1] : undefined;

    switch (action.type) {
      case 'SET_DATA':
        return {
          data: action.payload
        };

      case LOCATION_CHANGE:
        return {
          data: []
        };

      default:
        return state;
    }
  },
  router: connectRouter(history)
}, routerMiddleware(history));

var readAndSetData = function readAndSetData() {
  var readCount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 2;
  return {
    type: 'SET_DATA',
    payload: [{
      id: 1,
      name: 'Franta Vomáčka'
    }, {
      id: 2,
      name: 'Julian Zápotocký'
    }].slice(0, readCount)
  };
};

var UsersList = function UsersList(_ref) {
  var users = _ref.users,
      loadingText = _ref.loadingText;
  return React.createElement("ul", null, users.length === 0 && loadingText, users.map(function (user) {
    return React.createElement("li", {
      key: user.id
    }, user.name);
  }));
};

UsersList.propTypes = {
  users: PropTypes.arrayOf(PropTypes.shape({
    id: PropTypes.number.isRequired,
    name: PropTypes.string.isRequired
  })).isRequired,
  loadingText: PropTypes.string.isRequired
};

var delayedDispatch = function delayedDispatch(dispatch, reduxAction) {
  return function () {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    setTimeout(function () {
      return dispatch(reduxAction.apply(void 0, args));
    }, 3000);
  };
};

storiesOf('HOC/routeDependencies', module).addDecorator(function (story) {
  return React.createElement(StoreProvider, {
    store: store
  }, React.createElement(ConnectedRouter, {
    history: history
  }, story()));
}).add('default enter handler', function () {
  var UsersListContainer = compose(connect(function (state) {
    return {
      users: state.users.data
    };
  }, function (dispatch) {
    return {
      read: delayedDispatch(dispatch, readAndSetData)
    };
  }), routeDependencies())(UsersList);
  return React.createElement(UsersListContainer, {
    loadingText: "Na\u010D\xEDt\xE1m v\u0161echny u\u017Eivatele..."
  });
}).add('custom enter handler', function () {
  var UsersListContainer = compose(connect(function (state) {
    return {
      users: state.users.data
    };
  }, function (dispatch) {
    return {
      read: delayedDispatch(dispatch, readAndSetData)
    };
  }), routeDependencies({
    onRouteEnter: function onRouteEnter(_ref2) {
      var read = _ref2.read;

      if (typeof read === 'function') {
        read(1);
      }
    }
  }))(UsersList);
  return React.createElement(UsersListContainer, {
    loadingText: "Na\u010D\xEDt\xE1m prvn\xEDho u\u017Eivatele..."
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9IT0Mvcm91dGVEZXBlbmRlbmNpZXMuc3RvcnkudHN4Il0sIm5hbWVzIjpbIlJlYWN0IiwiUHJvcFR5cGVzIiwiY3JlYXRlQnJvd3Nlckhpc3RvcnkiLCJzdG9yaWVzT2YiLCJjb21wb3NlIiwiY29ubmVjdCIsIlByb3ZpZGVyIiwiU3RvcmVQcm92aWRlciIsInJvdXRlck1pZGRsZXdhcmUiLCJjb25uZWN0Um91dGVyIiwiQ29ubmVjdGVkUm91dGVyIiwiTE9DQVRJT05fQ0hBTkdFIiwiY29uZmlndXJlU3RvcmUiLCJyb3V0ZURlcGVuZGVuY2llcyIsImhpc3RvcnkiLCJpbml0aWFsU3RhdGUiLCJ1c2VycyIsImRhdGEiLCJzdG9yZSIsInN0YXRlIiwiYWN0aW9uIiwidHlwZSIsInBheWxvYWQiLCJyb3V0ZXIiLCJyZWFkQW5kU2V0RGF0YSIsInJlYWRDb3VudCIsImlkIiwibmFtZSIsInNsaWNlIiwiVXNlcnNMaXN0IiwibG9hZGluZ1RleHQiLCJsZW5ndGgiLCJtYXAiLCJ1c2VyIiwicHJvcFR5cGVzIiwiYXJyYXlPZiIsInNoYXBlIiwibnVtYmVyIiwiaXNSZXF1aXJlZCIsInN0cmluZyIsImRlbGF5ZWREaXNwYXRjaCIsImRpc3BhdGNoIiwicmVkdXhBY3Rpb24iLCJhcmdzIiwic2V0VGltZW91dCIsIm1vZHVsZSIsImFkZERlY29yYXRvciIsInN0b3J5IiwiYWRkIiwiVXNlcnNMaXN0Q29udGFpbmVyIiwicmVhZCIsIm9uUm91dGVFbnRlciJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBT0EsS0FBUCxNQUFrQixPQUFsQjtBQUNBLE9BQU9DLFNBQVAsTUFBc0IsWUFBdEI7QUFDQSxTQUFTQyxvQkFBVCxRQUFxQyxTQUFyQztBQUNBLFNBQVNDLFNBQVQsUUFBMEIsa0JBQTFCO0FBQ0EsU0FBb0JDLE9BQXBCLFFBQTRELE9BQTVEO0FBQ0EsU0FBU0MsT0FBVCxFQUFrQkMsUUFBUSxJQUFJQyxhQUE5QixRQUFtRCxhQUFuRDtBQUNBLFNBQVND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QkFBaUIsQ0FBQztBQUNkc0MsSUFBQUEsWUFBWSxFQUFFLDZCQUFjO0FBQUEsVUFBWEQsSUFBVyxTQUFYQSxJQUFXOztBQUN4QixVQUFJLE9BQU9BLElBQVAsS0FBZ0IsVUFBcEIsRUFBZ0M7QUFDNUJBLFFBQUFBLElBQUksQ0FBQyxDQUFELENBQUo7QUFDSDtBQUNKO0FBTGEsR0FBRCxDQVBhLENBQVAsQ0FjekJyQixTQWR5QixDQUEzQjtBQWdCQSxTQUFPLG9CQUFDLGtCQUFEO0FBQW9CLElBQUEsV0FBVyxFQUFDO0FBQWhDLElBQVA7QUFDSCxDQW5DTCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHsgY3JlYXRlQnJvd3Nlckhpc3RvcnkgfSBmcm9tICdoaXN0b3J5JztcbmltcG9ydCB7IHN0b3JpZXNPZiB9IGZyb20gJ0BzdG9yeWJvb2svcmVhY3QnO1xuaW1wb3J0IHsgQW55QWN0aW9uLCBjb21wb3NlLCBEaXNwYXRjaCwgQWN0aW9uQ3JlYXRvciB9IGZyb20gJ3JlZHV4JztcbmltcG9ydCB7IGNvbm5lY3QsIFByb3ZpZGVyIGFzIFN0b3JlUHJvdmlkZXIgfSBmcm9tICdyZWFjdC1yZWR1eCc7XG5pbXBvcnQgeyByb3V0ZXJNaWRkbGV3YXJlLCBjb25uZWN0Um91dGVyLCBDb25uZWN0ZWRSb3V0ZXIsIExPQ0FUSU9OX0NIQU5HRSB9IGZyb20gJ2Nvbm5lY3RlZC1yZWFjdC1yb3V0ZXInO1xuXG5pbXBvcnQgeyBjb25maWd1cmVTdG9yZSB9IGZyb20gJy4uLy4uL3N0b3JpZXMnO1xuaW1wb3J0IHJvdXRlRGVwZW5kZW5jaWVzIGZyb20gJy4vcm91dGVEZXBlbmRlbmNpZXMnO1xuXG5leHBvcnQgY29uc3QgaGlzdG9yeSA9IGNyZWF0ZUJyb3dzZXJIaXN0b3J5KCk7XG5cbmNvbnN0IGluaXRpYWxTdGF0ZSA9IHtcbiAgICB1c2Vyczoge1xuICAgICAgICBkYXRhOiBbXSxcbiAgICB9LFxufTtcblxuY29uc3Qgc3RvcmUgPSBjb25maWd1cmVTdG9yZShcbiAgICBpbml0aWFsU3RhdGUsXG4gICAge1xuICAgICAgICB1c2VyczogKHN0YXRlID0geyBkYXRhOiBbXSB9LCBhY3Rpb246IEFueUFjdGlvbikgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1NFVF9EQVRBJzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGFjdGlvbi5wYXlsb2FkLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNhc2UgTE9DQVRJT05fQ0hBTkdFOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogW10sXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByb3V0ZXI6IGNvbm5lY3RSb3V0ZXIoaGlzdG9yeSksXG4gICAgfSxcbiAgICByb3V0ZXJNaWRkbGV3YXJlKGhpc3RvcnkpLFxuKTtcblxuY29uc3QgcmVhZEFuZFNldERhdGEgPSAocmVhZENvdW50OiBudW1iZXIgPSAyKSA9PiAoe1xuICAgIHR5cGU6ICdTRVRfREFUQScsXG4gICAgcGF5bG9hZDogW3sgaWQ6IDEsIG5hbWU6ICdGcmFudGEgVm9tw6HEjWthJyB9LCB7IGlkOiAyLCBuYW1lOiAnSnVsaWFuIFrDoXBvdG9ja8O9JyB9XS5zbGljZSgwLCByZWFkQ291bnQpLFxufSk7XG5cbmludGVyZmFjZSBVc2VyIHtcbiAgICBpZDogbnVtYmVyO1xuICAgIG5hbWU6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgICB1c2VyczogVXNlcltdO1xuICAgIGxvYWRpbmdUZXh0OiBzdHJpbmc7XG59XG5cbnR5cGUgQ29tcG9uZW50UHJvcHMgPSBQaWNrPFByb3BzLCAnbG9hZGluZ1RleHQnPjtcblxuY29uc3QgVXNlcnNMaXN0ID0gKHsgdXNlcnMsIGxvYWRpbmdUZXh0IH06IFByb3BzKSA9PiAoXG4gICAgPHVsPlxuICAgICAgICB7dXNlcnMubGVuZ3RoID09PSAwICYmIGxvYWRpbmdUZXh0fVxuICAgICAgICB7dXNlcnMubWFwKCh1c2VyOiBVc2VyKSA9PiAoXG4gICAgICAgICAgICA8bGkga2V5PXt1c2VyLmlkfT57dXNlci5uYW1lfTwvbGk+XG4gICAgICAgICkpfVxuICAgIDwvdWw+XG4pO1xuXG5Vc2Vyc0xpc3QucHJvcFR5cGVzID0ge1xuICAgIHVzZXJzOiBQcm9wVHlwZXMuYXJyYXlPZihcbiAgICAgICAgUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgICAgIGlkOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgICAgICAgICBuYW1lOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIH0pLFxuICAgICkuaXNSZXF1aXJlZCxcbiAgICBsb2FkaW5nVGV4dDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxufTtcblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgICB1c2Vyczoge1xuICAgICAgICBkYXRhOiBVc2VyW107XG4gICAgfTtcbn1cblxuY29uc3QgZGVsYXllZERpc3BhdGNoID0gKGRpc3BhdGNoOiBEaXNwYXRjaCwgcmVkdXhBY3Rpb246IEFjdGlvbkNyZWF0b3I8YW55PikgPT4ge1xuICAgIHJldHVybiAoLi4uYXJnczogYW55W10pID0+IHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBkaXNwYXRjaChyZWR1eEFjdGlvbiguLi5hcmdzKSksIDMwMDApO1xuICAgIH07XG59O1xuXG5zdG9yaWVzT2YoJ0hPQy9yb3V0ZURlcGVuZGVuY2llcycsIG1vZHVsZSlcbiAgICAuYWRkRGVjb3JhdG9yKHN0b3J5ID0+IChcbiAgICAgICAgPFN0b3JlUHJvdmlkZXIgc3RvcmU9e3N0b3JlfT5cbiAgICAgICAgICAgIDxDb25uZWN0ZWRSb3V0ZXIgaGlzdG9yeT17aGlzdG9yeX0+e3N0b3J5KCl9PC9Db25uZWN0ZWRSb3V0ZXI+XG4gICAgICAgIDwvU3RvcmVQcm92aWRlcj5cbiAgICApKVxuICAgIC5hZGQoJ2RlZmF1bHQgZW50ZXIgaGFuZGxlcicsICgpID0+IHtcbiAgICAgICAgY29uc3QgVXNlcnNMaXN0Q29udGFpbmVyID0gY29tcG9zZTxSZWFjdC5TRkM8Q29tcG9uZW50UHJvcHM+PihcbiAgICAgICAgICAgIGNvbm5lY3QoXG4gICAgICAgICAgICAgICAgKHN0YXRlOiBTdGF0ZSkgPT4gKHsgdXNlcnM6IHN0YXRlLnVzZXJzLmRhdGEgfSksXG4gICAgICAgICAgICAgICAgZGlzcGF0Y2ggPT4gKHsgcmVhZDogZGVsYXllZERpc3BhdGNoKGRpc3BhdGNoLCByZWFkQW5kU2V0RGF0YSkgfSksXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgcm91dGVEZXBlbmRlbmNpZXMoKSxcbiAgICAgICAgKShVc2Vyc0xpc3QpO1xuXG4gICAgICAgIHJldHVybiA8VXNlcnNMaXN0Q29udGFpbmVyIGxvYWRpbmdUZXh0PVwiTmHEjcOtdMOhbSB2xaFlY2hueSB1xb5pdmF0ZWxlLi4uXCIgLz47XG4gICAgfSlcbiAgICAuYWRkKCdjdXN0b20gZW50ZXIgaGFuZGxlcicsICgpID0+IHtcbiAgICAgICAgY29uc3QgVXNlcnNMaXN0Q29udGFpbmVyID0gY29tcG9zZTxSZWFjdC5TRkM8Q29tcG9uZW50UHJvcHM+PihcbiAgICAgICAgICAgIGNvbm5lY3QoXG4gICAgICAgICAgICAgICAgKHN0YXRlOiBTdGF0ZSkgPT4gKHsgdXNlcnM6IHN0YXRlLnVzZXJzLmRhdGEgfSksXG4gICAgICAgICAgICAgICAgZGlzcGF0Y2ggPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgcmVhZDogZGVsYXllZERpc3BhdGNoKGRpc3BhdGNoLCByZWFkQW5kU2V0RGF0YSksXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgcm91dGVEZXBlbmRlbmNpZXMoe1xuICAgICAgICAgICAgICAgIG9uUm91dGVFbnRlcjogKHsgcmVhZCB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVhZCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZCgxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgKShVc2Vyc0xpc3QpO1xuXG4gICAgICAgIHJldHVybiA8VXNlcnNMaXN0Q29udGFpbmVyIGxvYWRpbmdUZXh0PVwiTmHEjcOtdMOhbSBwcnZuw61obyB1xb5pdmF0ZWxlLi4uXCIgLz47XG4gICAgfSk7XG4iXX0=